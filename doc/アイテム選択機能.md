#### 4.3. PBI-04: アイテム選択機能
- **担当モジュール:** **`SpotifyManager.Playlist.dll`** (ViewModel) / **`SpotifyManager.Wpf.exe`** (View)
- **仕様:**
    - プレイリストおよび楽曲の各項目にチェックボックスを設け、ユーザーが削除対象を複数選択できるようにする。ViewModelのプロパティとViewのコントロールをデータバインディングで連携させる。
    - **親子チェックボックスの連動:**
        1.  プレイリストのチェックボックスは、3状態（ON, OFF, 中間）をサポートする。WPFの`CheckBox`コントロールの`IsChecked`プロパティを`bool?` (nullable boolean) 型として実装する。
        2.  配下の楽曲のチェック状態に応じて、親であるプレイリストのチェックボックスの状態は以下のように自動的に更新される。
            -   全楽曲がチェックされている場合: プレイリストのチェックボックスは **ON** (`true`) になる。
            -   全楽曲のチェックが外れている場合: プレイリストのチェックボックスは **OFF** (`false`) になる。
            -   一部の楽曲のみがチェックされている場合: プレイリストのチェックボックスは **中間状態** (`null`) になる。
        3.  ユーザーがプレイリストのチェックボックスを直接クリックした場合、配下の全楽曲のチェック状態が一括で変更される。
            -   チェックボックスを **ON** にすると、配下の全楽曲がチェックされる。
            -   チェックボックスを **OFF** にすると、配下の全楽曲のチェックが外れる。
    - **Shiftキーによる範囲選択:**
        1.  楽曲リスト内でのみ、Shiftキーを使用した範囲選択を可能にする。
        2.  ユーザーが特定の楽曲をクリックした後、Shiftキーを押しながら別の楽曲をクリックすると、その間のすべての楽曲が、最初にクリックした楽曲のチェック状態に合わせて一括でONまたはOFFになる。
        3.  この機能は、プレイリスト間の範囲選択には適用されない。

- **受け入れ基準:**
    - GIVEN: メイン画面にアイテムが表示されているとき
    - WHEN: ユーザーがプレイリストまたは楽曲のチェックボックスをクリックすると
    - THEN: そのチェックボックスのON/OFF状態が切り替わること。
    - GIVEN: 画面上にチェックされたアイテムが1つもないとき
    - THEN: 「Delete」ボタンが非活性であること。
    - GIVEN: 画面上にチェックされたアイテムが1つ以上あるとき
    - THEN: 「Delete」ボタンが活性化すること。
    - **[親子連動]**
    - GIVEN: あるプレイリスト内の楽曲が一部のみチェックされているとき
    - THEN: その親プレイリストのチェックボックスは中間状態（Indeterminate）で表示されること。
    - GIVEN: あるプレイリストのチェックボックスがOFFまたは中間状態のとき
    - WHEN: ユーザーがそのチェックボックスをクリックすると
    - THEN: そのプレイリスト自体と、配下の全楽曲のチェックボックスがONになること。
    - GIVEN: あるプレイリストのチェックボックスがONのとき
    - WHEN: ユーザーがそのチェックボックスをクリックすると
    - THEN: そのプレイリスト自体と、配下の全楽曲のチェックボックスがOFFになること。
    - **[範囲選択]**
    - GIVEN: ユーザーがある楽曲AをクリックしてチェックをONにした後
    - WHEN: Shiftキーを押しながら、リスト内の別の楽曲Cをクリックすると
    - THEN: 楽曲Aから楽曲Cまでのすべての楽曲のチェックボックスがONになること。
    - GIVEN: ユーザーがある楽曲AをクリックしてチェックをOFFにした後
    - WHEN: Shiftキーを押しながら、リスト内の別の楽曲Cをクリックすると
    - THEN: 楽曲Aから楽曲Cまでのすべての楽曲のチェックボックスがOFFになること。